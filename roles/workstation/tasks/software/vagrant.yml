---
- name: software | vagrant block
  block:
    - name: add apt key
      shell: curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add -
   
    - name: software | vagrant | add repository into sources list
      apt_repository:
        repo: 'deb [arch=amd64] https://apt.releases.hashicorp.com {{ ansible_distribution_release }} main'
        state: present
  
    - name: software | vagrant | update repo and install vagrant & dependencies
      apt:
        pkg:
          - vagrant
          - libxslt-dev
          - libxml2-dev
          - libvirt-dev
          - zlib1g-dev
          - ruby-dev
          - ruby-libvirt
          - ebtables
        state: present
        update_cache: true
        
    - name: Install plugin vagrant-libvirt
      command: 'vagrant plugin install vagrant-libvirt'

  when:
    - vagrant is defined
    - vagrant

